<div class="page-header">
  <h1>Erőforrások hibái</h1>
</div>


<!-- Modal -->
<div class="modal fade" id="commentModal" tabindex="-1" role="dialog" aria-labelledby="commentModalLabel"
     aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title" id="myModalLabel">Hibajegy követés</h4>
      </div>
      <form method="post" accept-charset="UTF-8">
        <div class="modal-body">
          <div class="form-group">
            <label for="description">Megjegyzés</label>
            <input [(ngModel)]="actCommentToAppend" type="text" class="form-control" id="textToAppend" name="textToAppend"
                   placeholder="Hiba megoldásával kapcsolatos jegyzet"/>
          </div>
          <div class="checkbox">
            <label>
              <input [(ngModel)]="actResourceFaultUpdate.active" type="checkbox" id="commentActive" name="commentActive" checked="checked"/>
              Aktív
              <small>(még mindig fennáll)</small>
            </label>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Bezárás</button>
          <input (click)="submitModal()" type="submit" class="btn btn-primary" value="Mentés"/>
        </div>
      </form>
    </div>
  </div>
</div>


<div class="panel panel-default">
  <div class="panel-heading"><a data-toggle="collapse" href="#collapseFault" aria-expanded="false"
                                aria-controls="collapseFault">Új hibajegy hozzáadása</a></div>
  <div class="panel-body collapse" id="collapseFault">
    <form method="post" accept-charset="UTF-8">
      <div class="form-group">
        <label for="resourceID">Erőforrás</label>
        <select [(ngModel)]="actResourceFault.resource" class="form-control" id="resourceID" name="resourceID">
          <option *ngFor="let r of resources" [ngValue]="r">{{r.resourceName}}</option>
        </select>
      </div>
      <div class="form-group">
        <label for="resourceName">Hiba rövid leírása</label>
        <input [(ngModel)]="actResourceFault.shortDescription" type="text" class="form-control" id="resourceName"
               name="shortDescription" placeholder="Rövid leírás"
               value=""/>
      </div>
      <div class="form-group">
        <label for="description">Hiba leírása</label>
        <input [(ngModel)]="actResourceFault.longDescription" type="text" class="form-control" id="description"
               name="longDescription" placeholder="Hosszú leírás"
               value=""/>
      </div>


      <div class="checkbox">
        <label>
          <input [(ngModel)]="actResourceFault.active" type="checkbox" id="active" name="active" value="true"/>
          Aktív
          <small>(még mindig fennáll)</small>
        </label>
      </div>
      <input (click)="onResourceFaultFormSubmit()" type="submit" class="btn btn-primary btn-block" value="Küldés"/>
    </form>
  </div>
</div>

<table class="table table-hovered table-bordered">
  <thead>
  <th>Erőforrás neve</th>
  <th>Hiba leírása</th>
  <th>Hiba hosszú leírás</th>
  <th>Eszközök</th>
  </thead>
  <tbody>
  <tr *ngFor="let rf of resourceFaults" [ngClass]="rf.active == false ? 'notActive' : ''">
    <td>{{rf.resource.resourceName}}</td>
    <td>{{rf.shortDescription}}</td>
    <td>{{rf.longDescription}}</td>
    <td>
      <button class="btn btn-info" (click)="showModal(rf)" data-toggle="modal" data-target="#commentModal"><span class="glyphicon glyphicon-pencil"></span> Módosítás
      </button>
    </td>
  </tr>
  </tbody>
</table>

<script type="text/javascript">
  $('#commentModal').on('show.bs.modal', function (event) {
    var button = $(event.relatedTarget) // Button that triggered the modal
    var transferredID = button.data('whatever') // Extract info from data-* attributes
    // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
    // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
    var modal = $(this)
    modal.find('#FaultID').val(transferredID)
  })
</script>
